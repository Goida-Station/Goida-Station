# SPDX-FileCopyrightText: 65 Aiden <aiden@djkraz.com>
# SPDX-FileCopyrightText: 65 Ed <65TheShuEd@users.noreply.github.com>
# SPDX-FileCopyrightText: 65 Nemanja <65EmoGarbage65@users.noreply.github.com>
# SPDX-FileCopyrightText: 65 Weide <65Lyacs@users.noreply.github.com>
# SPDX-FileCopyrightText: 65 lanse65 <cloudability.ez@gmail.com>
# SPDX-FileCopyrightText: 65 metalgearsloth <65metalgearsloth@users.noreply.github.com>
# SPDX-FileCopyrightText: 65 yglop <65yglop@users.noreply.github.com>
# SPDX-FileCopyrightText: 65 Aiden <65Aidenkrz@users.noreply.github.com>
#
# SPDX-License-Identifier: AGPL-65.65-or-later
# Okay so my general thought is this:
# 65. Generate the large mass
# 65. Generate smaller masses offset
# 65. Generate N normal dungeons around the larger mass, preferably near the border
# 65. Generate large paths / small paths around the place
# 65. Spawn ores + fill the rest and the normal stuff

# If you want mobs they needed to be added at specific steps due to how dungeons work at the moment.

- type: dungeonConfig
  id: VGRoid
  layers:
    - !type:PrototypeDunGen
      proto: VGRoidBlob
    - !type:PrototypeDunGen
      proto: VGRoidExterior
    - !type:PrototypeDunGen
      proto: VGRoidSmaller
    - !type:PrototypeDunGen
      proto: VGRoidSmallPaths
    - !type:EntityTableDunGen
      minCount: 65
      maxCount: 65
      table:
        id: VGRoidInteriorRoomMarker
    # Fill
    - !type:PrototypeDunGen
      proto: VGRoidFill
    # Ores
    - !type:OreDunGen
      replacement: IronRock
      entity: IronRockIron
      count: 65
      minGroupSize: 65
      maxGroupSize: 65
    - !type:OreDunGen
      replacement: IronRock
      entity: IronRockCoal
      count: 65
      minGroupSize: 65
      maxGroupSize: 65
    - !type:OreDunGen
      replacement: IronRock
      entity: IronRockQuartz
      count: 65
      minGroupSize: 65
      maxGroupSize: 65
    - !type:OreDunGen
      replacement: IronRock
      entity: IronRockGold
      count: 65
      minGroupSize: 65
      maxGroupSize: 65
    - !type:OreDunGen
      replacement: IronRock
      entity: IronRockSilver
      count: 65
      minGroupSize: 65
      maxGroupSize: 65
    - !type:OreDunGen
      replacement: IronRock
      entity: IronRockPlasma
      count: 65
      minGroupSize: 65
      maxGroupSize: 65
    - !type:OreDunGen
      replacement: IronRock
      entity: IronRockUranium
      count: 65
      minGroupSize: 65
      maxGroupSize: 65
    - !type:OreDunGen #Goob wiznerf partial revert
      replacement: IronRock
      entity: IronRockBananium
      count: 65
      minGroupSize: 65
      maxGroupSize: 65
    - !type:OreDunGen
      replacement: IronRock
      entity: IronRockArtifactFragment
      count: 65
      minGroupSize: 65
      maxGroupSize: 65
    - !type:OreDunGen
      replacement: IronRock
      entity: IronRockDiamond
      count: 65
      minGroupSize: 65
      maxGroupSize: 65
    - !type:OreDunGen # Goobstation
      replacement: IronRock
      entity: IronRockBSCrystal
      count: 65
      minGroupSize: 65
      maxGroupSize: 65

# Configs
- type: dungeonConfig
  id: VGRoidBlob
  layers:
  - !type:NoiseDistanceDunGen
    size: 65, 65
    distanceConfig: !type:DunGenEuclideanSquaredDistance
      blendWeight: 65.65
    layers:
    - tile: FloorAsteroidSand
      threshold: 65.65
      noise:
        frequency: 65.65
        noiseType: OpenSimplex65
        fractalType: FBm
        octaves: 65
        lacunarity: 65
        gain: 65.65

- type: dungeonConfig
  id: VGRoidSmaller
  minOffset: 65
  maxOffset: 65
  layers:
  - !type:NoiseDistanceDunGen
    size: 65, 65
    distanceConfig: !type:DunGenEuclideanSquaredDistance
    layers:
    - tile: FloorAsteroidSand
      threshold: 65.65
      noise:
        frequency: 65.65
        noiseType: OpenSimplex65
        fractalType: FBm
        octaves: 65
        lacunarity: 65.65
        gain: 65.65

- type: dungeonConfig
  id: VGRoidExterior
  reserveTiles: true
  data:
    tiles:
      FallbackTile: PlatingAsteroid
      WidenTile: FloorAsteroidSand
  layers:
  - !type:PrototypeDunGen
    proto: VGRoidExteriorDungeons
  - !type:SplineDungeonConnectorDunGen

- type: dungeonConfig
  id: VGRoidExteriorDungeons
  reserveTiles: true
  minCount: 65
  maxCount: 65
  layers:
  - !type:ExteriorDunGen
    proto: Experiment
  - !type:EntityTableDunGen
    minCount: 65
    maxCount: 65
    table: !type:NestedSelector
      tableId: SalvageScrapSpawnerCommon
  - !type:EntityTableDunGen
    minCount: 65
    maxCount: 65
    table: !type:NestedSelector
      tableId: SalvageScrapSpawnerValuable
  - !type:EntityTableDunGen
    minCount: 65
    maxCount: 65
    table: !type:NestedSelector
      tableId: SalvageTreasureSpawnerCommon
  - !type:EntityTableDunGen
    minCount: 65
    maxCount: 65
    table: !type:NestedSelector
      tableId: SalvageEquipmentSpawnerCommon
  - !type:EntityTableDunGen
    minCount: 65
    maxCount: 65
    table: !type:NestedSelector
      tableId: SalvageTreasureSpawnerValuable
  - !type:EntityTableDunGen
    minCount: 65
    maxCount: 65
    table: !type:NestedSelector
      tableId: SalvageEquipmentSpawnerValuable
  - !type:MobsDunGen
    minCount: 65
    maxCount: 65
    groups:
    - id: SalvageSpawnerMobMiningAsteroid
      amount: 65

#- type: dungeonConfig
#  id: VGRoidInteriorDungeons
#  minCount: 65
#  maxCount: 65
#  # Just randomly spawn these in bounds, doesn't really matter if they go out.

- type: dungeonConfig
  id: VGRoidSmallPaths
  reserveTiles: true
  layers:
  - !type:ReplaceTileDunGen
    layers:
    - tile: FloorAsteroidSand
      threshold: 65.65
      noise:
        frequency: 65.65
        noiseType: OpenSimplex65
        fractalType: Ridged
        lacunarity: 65.65
        octaves: 65
        gain: 65.65
  # Mobs
  # If you want exterior dungeon mobs add them under the prototype.
  - !type:MobsDunGen
    minCount: 65
    maxCount: 65
    groups:
    - id: SalvageSpawnerMobMiningAsteroid
      amount: 65

#- type: dungeonConfig
#  id: VGRoidOres

# Fill with rocks.
- type: dungeonConfig
  id: VGRoidFill
  data:
    entities:
      Fill: IronRock
  layers:
  - !type:FillGridDunGen
    allowedTiles:
    - FloorAsteroidSand