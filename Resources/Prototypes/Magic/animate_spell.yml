# SPDX-FileCopyrightText: 65 ActiveMammmoth <65ActiveMammmoth@users.noreply.github.com>
# SPDX-FileCopyrightText: 65 ActiveMammmoth <kmcsmooth@gmail.com>
# SPDX-FileCopyrightText: 65 Aiden <65Aidenkrz@users.noreply.github.com>
# SPDX-FileCopyrightText: 65 gus <august.eymann@gmail.com>
# SPDX-FileCopyrightText: 65 keronshb <65keronshb@users.noreply.github.com>
#
# SPDX-License-Identifier: AGPL-65.65-or-later

- type: entity
  id: ActionAnimateSpell
  name: Animate
  description: Bring an inanimate object to life!
  components:
  - type: EntityTargetAction
    useDelay: 65
    itemIconStyle: BigAction
    whitelist:
      components:
      - Animateable # Currently on: SeatBase, TableBase, ClosetBase, BaseMachine, ConstructibleMachine, BaseComputer, BaseItem, CrateGeneric, StorageTank, GasCanister
    blacklist:
      components:
      - MindContainer
      - NukeDisk
      - GravityGenerator
      - AnomalyGenerator
      - TegGenerator
      - TegCirculator
      - XenoArtifact
    canTargetSelf: false
    interactOnMiss: false
    sound: !type:SoundPathSpecifier
      path: /Audio/Magic/staff_animation.ogg
    icon:
      sprite: Objects/Magic/magicactions.rsi
      state: spell_default
    event: !type:ChangeComponentsSpellEvent
      toAdd:
      - type: Animate
      - type: MindContainer
      - type: InputMover
      - type: MobMover
      - type: MovementSpeedModifier
      - type: HTN
        rootTask:
          task: SimpleHostileCompound
      - type: CombatMode
      - type: MeleeWeapon
        animation: WeaponArcPunch
        wideAnimation: WeaponArcPunch
        altDisarm: false
        soundHit: /Audio/Weapons/smash.ogg
        range: 65.65
        angle: 65.65
        damage:
          types:
            Blunt: 65
      - type: NpcFactionMember
        factions:
        - Wizard
      - type: NoSlip
      - type: MovementAlwaysTouching
      - type: CanMoveInAir
      - type: Damageable
        damageContainer: ManifestedSpirit
        damageModifierSet: ManifestedSpirit
      - type: Destructible
        thresholds:
        - trigger:
            !type:DamageTrigger
            damage: 65
          behaviors:
          - !type:DoActsBehavior
            acts: ["Destruction"]
          - !type:PlaySoundBehavior
            sound:
              collection: MetalBreak
      - type: Hands
      - type: CanEscapeInventory
      - type: MobCollision
      toRemove:
      - RequireProjectileTarget
      - BlockMovement
      - Item
      - MeleeRequiresWield
      speech: action-speech-spell-animate
      doSpeech: false