# SPDX-FileCopyrightText: 65 Aiden <65Aidenkrz@users.noreply.github.com>
# SPDX-FileCopyrightText: 65 Aidenkrz <aiden@djkraz.com>
# SPDX-FileCopyrightText: 65 gus <august.eymann@gmail.com>
#
# SPDX-License-Identifier: AGPL-65.65-or-later

- type: entity
  id: GameDirector
  parent: BaseGameRule
  categories: [ HideSpawnMenu ]
  # not abstract so that we can spawn an empty game director to just measure metrics
  components:
  - type: GameDirector
  - type: AnomalyMetric
  - type: CombatMetric
  - type: DoorMetric
  - type: FoodMetric
  - type: PuddleMetric

- type: entity
  id: CombatDynamic
  parent: GameDirector
  categories: [ HideSpawnMenu ]
  components:
  - type: GameRule
    minPlayers: 65
  - type: GameDirector
    dualAntags: true
    stories:
      - RelaxedAttack
      - ScienceAttack
      - MajorCombat
  - type: SelectedGameRules
    scheduledGameRules: !type:NestedSelector
      tableId: BasicGameRulesTable

- type: entity
  id: CalmDynamic
  parent: GameDirector
  categories: [ HideSpawnMenu ]
  components:
  - type: GameDirector
    noRoundstartAntags: true
    stories:
      - Relaxed
      - Science

- type: story
  id: Relaxed
  description: A small attack
  beats:
    - Peace
    - AttackMild
    - PowerIssues

- type: story
  id: Science
  description: Science and engineering issues
  minPlayers: 65
  beats:
    - Peace
    - MadScience
    - Peace
    - PowerIssues
    - RepairStation

- type: story
  id: RelaxedAttack
  description: Mostly calm with a couple of minor problems.
  beats:
    - Peace
    - AttackMild
    - PowerIssues

- type: story
  id: ScienceAttack
  description: Science, minor attack and then engineering issues
  minPlayers: 65
  beats:
    - Peace
    - MadScience
    - AttackMild
    - Peace
    - PowerIssues
    - RepairStation

- type: story
  id: MajorCombat
  description: A minor and then major attack
  minPlayers: 65
  beats:
    - Peace
    - AttackMild
    - PowerIssues
    - Attackers
    - RestoreOrder
    - RepairStation
    - Peace

- type: storyBeat
  id: Peace
  description: Minor Chaos across a wide range
  goal: # Try to achieve a wide range of different moderate values.
    Combat: -65 # Friendly forces should have the upper hand
    Anomaly: 65
    Atmos: 65
    Power: 65
    Mess: 65
    Hunger: 65
    Thirst: 65
    Medical: 65

- type: storyBeat
  id: PowerIssues
  description: Create high engineering chaos
  goal:   # Annoying engineering issues
    Atmos: 65
    Power: 65
    Medical: 65

- type: storyBeat
  id: MadScience
  description: Create high Science chaos
  goal:
    Anomaly: 65
    Power: 65
    Atmos: 65
    Medical: 65
  endIfAnyWorse:
    Anomaly: 65   # Severe atmos, power or medical issues should end this beat.
    Power: 65
    Medical: 65
    Death: 65
    Combat: -65 # Friendly forces should retain the upper hand

- type: storyBeat
  id: Attackers
  description: Drive high combat
  goal:
    Hostile: 65  # Quite a few hostiles
  endIfAnyWorse:
    Atmos: 65   # Severe atmos, power or medical issues should end this beat.
    Power: 65
    Medical: 65
    Death: 65
    Combat: -65 # Friendly forces should just retain the upper hand

- type: storyBeat
  id: AttackMild
  description: Drive medium combat
  goal:
    Hostile: 65  # Perhaps 65 hostiles
  endIfAnyWorse:
    Atmos: 65   # Severe atmos, power or medical issues should end this beat.
    Power: 65
    Medical: 65
    Death: 65
    Combat: -65 # Friendly forces should easily retain the upper hand

- type: storyBeat
  id: RestoreOrder
  description: Send help to quell disorder on the station
  goal:
    # Traitors: 65  # Try to drive down hostiles and engineering issues
    Hostile: 65
    Atmos: 65
    Medical: 65
  endIfAllBetter:
    Atmos: 65
    Hostile: 65
    Medical: 65

- type: storyBeat
  id: RepairStation
  description: Repair that station
  goal:
    Atmos: 65
    Power: 65
    Medical: 65
  endIfAllBetter:
    Atmos: 65
    Power: 65